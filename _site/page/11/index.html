<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="utf-8">
  
  <title>桃子的博客铭</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="淡泊明志，宁静致远！">
<meta property="og:type" content="website">
<meta property="og:title" content="桃子的博客铭">
<meta property="og:url" content="https://taozj.org/page/11/index.html">
<meta property="og:site_name" content="桃子的博客铭">
<meta property="og:description" content="淡泊明志，宁静致远！">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="桃子的博客铭">
<meta name="twitter:description" content="淡泊明志，宁静致远！">
  
    <link rel="alternative" href="/atom.xml" title="桃子的博客铭" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
      <link href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css" rel="stylesheet">
  
  
      <link href="//cdn.bootcss.com/jqueryui/1.10.4/css/jquery-ui.min.css" rel="stylesheet">
  
  
      <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
      <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">
  
  <link rel="stylesheet" href="/css/style.css">
  
      <style> .article { opacity: 0;} </style>
  
  <link href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/iconfont.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
    
    
  
  
      <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">
  
  <script src="//cdn.bootcss.com/jquery/1.9.1/jquery.min.js"></script>
  <script src="//cdn.bootcss.com/clipboard.js/1.5.9/clipboard.min.js"></script>
  <script>
      var yiliaConfig = {
          fancybox: true,
          animate: true,
          isHome: true,
          isPost: false,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: true,
          fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
          scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.0.9/scrollreveal.min.js"
      }
  </script>

  
      <script>
          yiliaConfig.rootUrl = "/";
      </script>
  

  
  
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/post_images/resources/avatar.jpeg" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">taozj</a></h1>
        </hgroup>

        
        <p class="header-subtitle">高性能、高可用服务端开发</p>
        
        <br>
        
        <p class="header-subtitle">淡泊明志，宁静致远！</p>
        
                


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/archives">文章归档</a></li>
                        
                            <li><a href="https://album.taozj.org">个人相册</a></li>
                        
                            <li><a href="https://wiki.taozj.org/doku.php">个人WiKi</a></li>
                        
                            <li><a href="/about">请你读我</a></li>
                        
                            <li><a href="/search.html">搜索本站</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/taozhijiang" title="GitHub"></a>
                            
                                <a class="fa 新浪微博" target="_blank" href="http://weibo.com/u/1683951363" title="新浪微博"></a>
                            
                                <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a>
                            
                                <a class="fa Email" target="_blank" href="mailto:dEB0YW96ai5vcmcK (base64)" title="Email"></a>
                            
                                <a class="fa QQ" target="_blank" href="/347714173" title="QQ"></a>
                            
                                <a class="fa Twitter" target="_blank" href="https://twitter.com/taozhijiang" title="Twitter"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/C-与Boost/">C++与Boost</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux开发/">Linux开发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/互联网/">互联网</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/内核/">内核</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分布式/">分布式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/协议/">协议</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/博客/">博客</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/后台开发/">后台开发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/工作/">工作</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/工作相关/">工作相关</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/开发/">开发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/开发基础/">开发基础</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数学/">数学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据结构和算法/">数据结构和算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/服务运维/">服务运维</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/机器学习/">机器学习</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/构架/">构架</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/架构/">架构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/生活杂感/">生活杂感</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/读书笔记/">读书笔记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/软件/">软件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/运维/">运维</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/造轮子/">造轮子</a></li></ul>
                    </div>
                </section>
                
                
                

                
            </div>
        </div>
    </header>                
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">taozj</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/post_images/resources/avatar.jpeg" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">taozj</a></h1>
            </hgroup>
            
            <p class="header-subtitle">高性能、高可用服务端开发</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/archives">文章归档</a></li>
                
                    <li><a href="https://album.taozj.org">个人相册</a></li>
                
                    <li><a href="https://wiki.taozj.org/doku.php">个人WiKi</a></li>
                
                    <li><a href="/about">请你读我</a></li>
                
                    <li><a href="/search.html">搜索本站</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/taozhijiang" title="GitHub"></a>
                            
                                <a class="fa 新浪微博" target="_blank" href="http://weibo.com/u/1683951363" title="新浪微博"></a>
                            
                                <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a>
                            
                                <a class="fa Email" target="_blank" href="mailto:dEB0YW96ai5vcmcK (base64)" title="Email"></a>
                            
                                <a class="fa QQ" target="_blank" href="/347714173" title="QQ"></a>
                            
                                <a class="fa Twitter" target="_blank" href="https://twitter.com/taozhijiang" title="Twitter"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我"/>
</nav>
      <div class="body-wrap">
  
    <article id="post-docker-examples" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/201510/docker-examples.html" class="article-date">
      <time datetime="2015-10-10T04:10:19.000Z" itemprop="datePublished">2015-10-10</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/201510/docker-examples.html">Docker容器技术使用实例</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
              <p>　　本来不想这么快研究这个东西的，实在是<strong>上一个VPS Provider太让人失望和无语</strong>了：服务器无法访问，告诉我服务器配置错误。我问那该怎么办，答复我要VPS要重装。网络不通，数据也无法备份，关键是我重装之后还是不能访问，他们也没找到问题，最后发现是只有某些版本的系统的网络能通，也是无语了。之前运行了近一年了没有出现问题，现在服务器的数据全部没了，很多的额服务器需要重新配置，这也让我对系统的运营和部署产生了足够的重视。<br>　　之前对Docker有一些了解，或许现在正是我这种情况的用武之地了，主要的服务和设置用Docker来部署，而私密的数据毕竟少量，自己按时备份。这样如果下次再出问题，几条命令就可以重新把环境部署回来了。<br>　　对于企业级的部署，docker也是一个很好的解决方案，因为你只需要关心容器特定版本的实现，而不用关系host的环境，就是说你的服务可能只开发了RHEL的版本，但是可以方便的被部署到CentOS、Debian、Ubuntu、CoreOS等各个发行版上去，虽然对原生的性能会有所损耗，但是在现在计算机的配置几乎可以忽略不计了，国外已经有银行用容器部署他们的业务了，可靠性也是得到验证了的，是不是很酷？</p>
<p>下面开工：</p>
<h1 id="1-注册账号">1.注册账号</h1><p>　　<a href="https://hub.docker.com/" title="DockerHub">DockerHub</a> 注册用户账号。这个DockerHub相当于GitHub类似的，可以免费帮你存储公有的容器，别人都可以访问和下载（所以前面强调私有的数据要另外保存），然后每个用户可以免费创建一个私有的容器，更多的私有容器就需要花美刀了，跟GitHub是一个运营模式。</p>
<h1 id="2-创建应用容器">2.创建应用容器</h1><h2 id="2-1_安装相应的工具">2.1 安装相应的工具</h2><p>　　我用的是Fedora 22 Server，这些东西默认就给我装上了，其它版本请参照官方的安装手册。(官方文档说的添加docker组可以让docker在非root用户下运行，但是试验发现、改变/var/run/docker.socket权限后会自动变回来，所以fedora是没有办法的，只能sudo了)。此外docker在fedora的官方维持了一个版本，同时docker自己也维持了一个版本，两者差不多。<br> <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">user@localhost  ~  sudo dnf install docker -y</div><div class="line">user@localhost  ~  sudo systemctl <span class="built_in">enable</span> docker</div><div class="line">user@localhost  ~  sudo systemctl restart docker</div><div class="line">user@localhost  ~  sudo docker run hello-world</div><div class="line">user@localhost  ~  sudo docker run -it fedora:22 ping 8.8.4.4</div></pre></td></tr></table></figure></p>
<p>直接使用<strong>docker</strong>可以查看docker的可用命令<br> <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">attach    Attach to a running container</div><div class="line">build     Build an image from a Dockerfile</div><div class="line">commit    Create a new image from a container<span class="string">'s changes</div><div class="line">cp        Copy files/folders from a container to a HOSTDIR or to STDOUT</div><div class="line">create    Create a new container</div><div class="line">diff      Inspect changes on a container'</span>s filesystem</div><div class="line"><span class="built_in">exec</span>      Run a <span class="built_in">command</span> <span class="keyword">in</span> a running container</div><div class="line"><span class="built_in">history</span>   Show the <span class="built_in">history</span> of an image</div><div class="line">images    List images</div><div class="line">info      Display system-wide information</div><div class="line"><span class="built_in">kill</span>      Kill a running container</div><div class="line">login     Register or <span class="built_in">log</span> <span class="keyword">in</span> to a Docker registry</div><div class="line"><span class="built_in">logout</span>    Log out from a Docker registry</div><div class="line">logs      Fetch the logs of a container</div><div class="line">pause     Pause all processes within a container</div><div class="line">port      List port mappings or a specific mapping <span class="keyword">for</span> the CONTAINER</div><div class="line">ps        List containers</div><div class="line">pull      Pull an image or a repository from a registry</div><div class="line">push      Push an image or a repository to a registry</div><div class="line">rename    Rename a container</div><div class="line">restart   Restart a running container</div><div class="line">rm        Remove one or more containers</div><div class="line">rmi       Remove one or more images</div><div class="line">run       Run a <span class="built_in">command</span> <span class="keyword">in</span> a new container</div><div class="line">save      Save an image(s) to a tar archive</div><div class="line">search    Search the Docker Hub <span class="keyword">for</span> images</div><div class="line">start     Start one or more stopped containers</div><div class="line">stop      Stop a running container</div><div class="line">tag       Tag an image into a repository</div><div class="line">top       Display the running processes of a container</div><div class="line">unpause   Unpause all processes within a container</div></pre></td></tr></table></figure></p>
          
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/服务运维/">服务运维</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/服务运维/">服务运维</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/软件/">软件</a></li></ul>
    </div>

      
        <p class="article-more-link">
          <a href="/201510/docker-examples.html#more">阅读全文 >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
</article>










  
    <article id="post-mail-server-based-on-postfix-dovecot" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/201510/mail-server-based-on-postfix-dovecot.html" class="article-date">
      <time datetime="2015-10-04T08:09:27.000Z" itemprop="datePublished">2015-10-04</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/201510/mail-server-based-on-postfix-dovecot.html">搭建基于Postfix和Dovecot的邮件服务器</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
              <p>最近帮飞哥搭建了一个Linux Mail Server，捣鼓了一天终于搞掂了。这里记录下来以备后用，由于时间仓促，很多参数和功能还不知所以然;-(。</p>
<h1 id="1-_服务器环境">1. 服务器环境</h1><p>操作系统：CentOS 7.1<br>环境：apache php mariadb<br>软件：postfix dovecot roundcubemail postfixadmin<br>其它：在域名商添加邮件服务器的A记录和MX记录，这里用的mail.freesign.net<br>     同时请<a href="&#39;https://buy.wosign.com/free/?lan=en#ssl&#39;">申请数字证书</a>，中文版页面的免费申请地址很难看到，估计就是故意不想让人找到的。前段时间还是3年的，现在签发只能管一年了。<br>关于LAMP环境的搭建网络上已经一大堆了，此处不表。Apache推荐开启https，因为postfixadmin和roundcubemail是网页端访问的，这样会比较安全。<br>    添加邮件专用用户vmail:vmail<br>    groupadd -g 5000 vmail<br>    useradd -g vmail -u 5000 vmail -d /home/vmail -m</p>
<h1 id="2-_邮件服务器搭建">2. 邮件服务器搭建</h1><h2 id="2-1_设置服务器">2.1 设置服务器</h2><p>在数据库中专门添加一个邮件的数据库。同时由于邮件服务器涉及到多个软件，这些软件的系统也是通过操作数据库的操作来实现的。<br> <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"> user@localhost  ~  mysql -u user -p</div><div class="line"> Enter password: </div><div class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</div><div class="line">Your MariaDB connection id is 3857</div><div class="line">Server version: 5.5.44-MariaDB MariaDB Server</div><div class="line"></div><div class="line">Copyright (c) 2000, 2015, Oracle, MariaDB Corporation Ab and others.</div><div class="line"></div><div class="line">Type <span class="string">'help;'</span> or <span class="string">'\h'</span> <span class="keyword">for</span> help. Type <span class="string">'\c'</span> to clear the current input statement.</div><div class="line"></div><div class="line">MariaDB [(none)]&gt; </div><div class="line">MariaDB [(none)]&gt; create database postfix;</div><div class="line">MariaDB [(none)]&gt; CREATE USER <span class="string">'postfix'</span>@<span class="string">'localhost'</span> IDENTIFIED BY <span class="string">'postfixadmin'</span>;</div><div class="line">MariaDB [(none)]&gt; CREATE USER <span class="string">'postfix'</span>@<span class="string">'localhost.localdomain'</span> IDENTIFIED BY <span class="string">'postfixadmin'</span>;</div><div class="line">MariaDB [(none)]&gt; GRANT ALL PRIVILEGES ON `postfix` . * TO <span class="string">'postfix'</span>@<span class="string">'localhost'</span>;</div><div class="line">MariaDB [(none)]&gt; GRANT ALL PRIVILEGES ON `postfix` . * TO <span class="string">'postfix'</span>@<span class="string">'localhost.localdomain'</span>;</div><div class="line">MariaDB [(none)]&gt; FLUSH PRIVILEGES;</div></pre></td></tr></table></figure></p>
<p>(把数据库操作过程的输出信息省略了)</p>
<h2 id="2-2_安装roundcubemail和postfixadmin">2.2 安装roundcubemail和postfixadmin</h2><p>postfixadmin没有被打包到库中，所以需要手动下载源代码来安装。roundcubemail是epel中被打包了的，可以直接yum安装。<br> <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">user@localhost  ~  sudo yum install roundcubemail</div><div class="line">user@localhost  ~  <span class="built_in">cd</span> /usr/share </div><div class="line">user@localhost  /usr/share  sudo wget wget http://jaist.dl.sourceforge.net/project/postfixadmin/postfixadmin/postfixadmin-2.93/postfixadmin-2.93.tar.gz</div><div class="line">user@localhost  /usr/share  sudo tar xzvf postfixadmin-2.93.tar.gz</div><div class="line">user@localhost  /usr/share  sudo mv postfixadmin-2.93 postfixadmin</div></pre></td></tr></table></figure></p>
<p>把postfixadmin解压到/usr/share目录，其实这步骤是跟roundcubemail学的。在安装roundcubemail 的时候，会在/etc/httpd/conf.d/roundcubemail.conf产生一个虚拟主机，对这个虚拟主机的别名和目录做如下设置<br> <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">Alias /roundcubemail /usr/share/roundcubemail</div><div class="line">Alias /mail /usr/share/roundcubemail</div><div class="line">Alias /postfixadmin /usr/share/postfixadmin</div><div class="line"></div><div class="line">&lt;Directory /usr/share/roundcubemail/&gt;</div><div class="line">        Options none</div><div class="line">        AllowOverride Limit</div><div class="line">        Require all granted</div><div class="line">&lt;/Directory&gt;</div><div class="line"></div><div class="line">&lt;Directory /usr/share/postfixadmin/&gt;</div><div class="line">        Options none</div><div class="line">        AllowOverride Limit</div><div class="line">        Require all granted</div><div class="line">&lt;/Directory&gt;</div><div class="line"></div><div class="line">&lt;Directory /usr/share/roundcubemail/installer&gt;</div><div class="line">        Options none</div><div class="line">        AllowOverride Limit</div><div class="line">        Require all granted</div><div class="line">&lt;/Directory&gt;</div></pre></td></tr></table></figure></p>
<p>记得重启apache服务器。</p>
<p>postfixadmin算是一个postfix的管理前端，邮件服务器管理域名和用户账户都在这里。解压之后修改config.inc.php文件（官方推荐是创建config.local.php文件，便于后续升级），其实最主要是数据库相关的设置信息(重要的修改列出如下)：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">$CONF[<span class="string">'configured'</span>] = <span class="keyword">true</span>;</div><div class="line">$CONF[<span class="string">'setup_password'</span>] = <span class="string">'abc123def'</span>;</div><div class="line">$CONF[<span class="string">'default_language'</span>] = <span class="string">'cn'</span>;</div><div class="line">$CONF[<span class="string">'database_type'</span>] = <span class="string">'mysqli'</span>;</div><div class="line">$CONF[<span class="string">'database_host'</span>] = <span class="string">'localhost'</span>;</div><div class="line">$CONF[<span class="string">'database_user'</span>] = <span class="string">'postfix'</span>;</div><div class="line">$CONF[<span class="string">'database_password'</span>] = <span class="string">'postfixadmin'</span>;</div><div class="line">$CONF[<span class="string">'database_name'</span>] = <span class="string">'postfix'</span>;</div><div class="line">$CONF[<span class="string">'admin_email'</span>] = <span class="string">'yourmailaddress@126.com'</span>;</div><div class="line">$CONF[<span class="string">'encrypt'</span>] = <span class="string">'dovecot:CRAM-MD5'</span>;</div><div class="line">$CONF[<span class="string">'dovecotpw'</span>] = <span class="string">"/usr/bin/doveadm pw"</span>;</div></pre></td></tr></table></figure></p>
<p>坑点说明：(1)setup_password需要满足密码复杂性要求，不是随便设置的，第一步设置明文，然后在页面生成加密后的密码，再将加密后的密文替换abc123def之后，才能进行添加管理员的操作；(2)encrypt需要修改，要跟后面其它部分设置一样；(3)CentOS7中doveadm打包到了/usr/bin目录，所以这里的路径需要更新；(4)templates_c目录的所属权限需要改为apache；<br>（postfixadmin的DOCUMENTS目录下的内容是个比较好的参考文档）</p>
<p>然后访问<strong><a href="https://mail.freesign.net/postfixadmin/setup.php">https://mail.freesign.net/postfixadmin/setup.php</a></strong>进行安装：第一步会生成加密的setup_passwd密码，替换config文件中的明文密码后，会让你创建一个管理账户，创建完成验证能登陆之后就先别做其它操作和设置了，因为很多东西还没有设置，创建域啥的没啥意义；<br>管理员和普通用户的管理路径在下面：<br><a href="https://mail.freesign.net/postfixadmin/login.php">https://mail.freesign.net/postfixadmin/login.php</a><br><a href="https://mail.freesign.net/postfixadmin/users/login.php">https://mail.freesign.net/postfixadmin/users/login.php</a></p>
          
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/服务运维/">服务运维</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/服务运维/">服务运维</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/软件/">软件</a></li></ul>
    </div>

      
        <p class="article-more-link">
          <a href="/201510/mail-server-based-on-postfix-dovecot.html#more">阅读全文 >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
</article>










  
    <article id="post-rpmbuild-package-example-(2)" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/201509/rpmbuild-package-example-(2).html" class="article-date">
      <time datetime="2015-09-30T09:34:27.000Z" itemprop="datePublished">2015-09-30</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/201509/rpmbuild-package-example-(2).html">RedHat系列软件打包实例（二）</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
              <p>　　上一篇算是对RPM软件一个简单的入门介绍。这一篇文章里，将对spec文件的各个参数进行较详细的探究和学习。其次，我们也将对strtest软件包进行改造，让它变的在Linux平台更“专业”像样一点。</p>
<h1 id="1-修改strtest文件">1.修改strtest文件</h1><p>　　这里，我们对strtest的源代码进行修改，让它变成一个类似于后台服务进程一样的。<br>　　当然不想弄一个复杂的服务端出来，因为这里只是进行验证测试：就让strtest心跳2s输出自己还活着的信息。由于现在的系统服务管理经过一段时间无力的抵制和抗议之后，全部屈服成systemd的了，所以这边也添加一个systemd的服务管理单元。<br>　　src/str.cpp的代码内容如下（原谅我一个披着CPP的纯C）<br> <figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">[makerpm@localhost SPECS]$ cat ~/dist/strtest<span class="number">-1.0</span><span class="number">.2</span>/src/str.cpp </div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"str.h"</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/time.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">char</span>* logfile = <span class="string">"/var/log/strtest.log"</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc , <span class="keyword">char</span> **argv)</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">struct</span> timeval tv;</div><div class="line">    <span class="keyword">time_t</span> timet;</div><div class="line">    <span class="keyword">struct</span> tm* timep;</div><div class="line">    FILE* fp = fopen(logfile,<span class="string">"a"</span>);</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(!fp) &#123;</div><div class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>,<span class="string">"Open logfile[%s] failed!\n"</span>, logfile);</div><div class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">    time(&amp;timet);</div><div class="line">    timep = localtime(&amp;timet); </div><div class="line">    </div><div class="line">    <span class="built_in">fprintf</span>(fp, <span class="string">"[%d-%d-%d %d:%d:%d]Starting service [%s] ...\n"</span>, timep-&gt;tm_year, timep-&gt;tm_mon, timep-&gt;tm_mday,</div><div class="line">            timep-&gt;tm_hour, timep-&gt;tm_min, timep-&gt;tm_sec, argv[<span class="number">0</span>]);</div><div class="line"></div><div class="line">    <span class="keyword">while</span>(<span class="literal">true</span>) &#123;</div><div class="line">        <span class="built_in">fprintf</span>(fp, <span class="string">"service[%s], I am alive --"</span>, argv[<span class="number">0</span>]);</div><div class="line">        <span class="keyword">if</span>(!gettimeofday(&amp;tv, <span class="literal">NULL</span>)) &#123;</div><div class="line">            <span class="built_in">fprintf</span>(fp, <span class="string">"system time info:%ds-%dus\n"</span>, tv.tv_sec, tv.tv_usec);</div><div class="line">        &#125;</div><div class="line">        fflush(fp);</div><div class="line">        sleep(<span class="number">2</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    fclose(fp);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1 id="2-添加strtest的systemd管理单元">2.添加strtest的systemd管理单元</h1><h2 id="2-1编写service文件">2.1编写service文件</h2><p>　　systemd依赖于service文件管理服务，放置在/usr/lib/systemd/目录下，注意的是，systemd管理单元应当是操作系统的一部分，而不是strtest软件代码的一部分，不应当打包到源代码下面，而应该将下面的strtest.service放到和strtest-1.0.2.tar.bz2一样的~/rpmbuild/SOURCES/目录下面。（这个service文件是抄袭的openssh滴！）关于systemd的相关信息，后面可能还会再学习整理，这里先不细究。<br> <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">[makerpm@localhost SOURCES]$ cat strtest.service </div><div class="line">[Unit]</div><div class="line">Description=Strtest server daemon</div><div class="line"></div><div class="line">[Service]</div><div class="line">ExecStart=/usr/bin/strtest <span class="variable">$OPTIONS</span></div><div class="line">ExecReload=/bin/<span class="built_in">kill</span> -HUP <span class="variable">$MAINPID</span></div><div class="line">KillMode=process</div><div class="line">Restart=on-failure</div><div class="line">RestartSec=42s</div><div class="line"></div><div class="line">[Install]</div><div class="line">WantedBy=multi-user.target</div></pre></td></tr></table></figure></p>
<h2 id="2-2_修正spec文件">2.2 修正spec文件</h2><p>　　修改strtest的源代码，对spec文件没有影响（主要是版本号和修改日志等无关紧要的）。目前主要修改使得strtest.service打包进去：<br>　　在%install部分，添加如下内容<br> <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 用于安装systemd服务</span></div><div class="line">install <span class="_">-d</span> -m755 <span class="variable">$RPM_BUILD_ROOT</span>/%&#123;_unitdir&#125;</div><div class="line">install -m644 %&#123;SOURCE1&#125; <span class="variable">$RPM_BUILD_ROOT</span>/%&#123;_unitdir&#125;/strtest.service</div></pre></td></tr></table></figure></p>
<p>然后在%file部分，添加如下内容<br> <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">%&#123;_unitdir&#125;/strtest.service</div></pre></td></tr></table></figure></p>
<p>OK, we all done!<br>
          
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/开发基础/">开发基础</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/开发基础/">开发基础</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/服务运维/">服务运维</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/软件/">软件</a></li></ul>
    </div>

      
        <p class="article-more-link">
          <a href="/201509/rpmbuild-package-example-(2).html#more">阅读全文 >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
</article>










  
    <article id="post-rpmbuild-package-example-(1)" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/201509/rpmbuild-package-example-(1).html" class="article-date">
      <time datetime="2015-09-28T07:55:16.000Z" itemprop="datePublished">2015-09-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/201509/rpmbuild-package-example-(1).html">RedHat系列RPM软件打包实例（一）</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
              <p>　　对于Linux操作系统，由于软件大部分都是开源软件构成，所以软件打包算是维护一个发行版的绝大多数任务。在Linux那个远古的时代，大家告诉你软件的安装都是下载源码、配置、编译和安装。</p>
<p>　　下面以Fedora 22为例子演示，CentOS可能会有一些差异，暂且不表。且是在本地进行打包的，没有用到Fedora的Koji系统。</p>
<h1 id="1-配置环境">1.配置环境</h1><h2 id="1-1_安装打包软件">1.1 安装打包软件</h2> <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">user@localhost  ~ sudo dnf install fedora-packager @development-tools rpmdevtools</div></pre></td></tr></table></figure>
<h2 id="1-2_配置打包环境">1.2 配置打包环境</h2><p>　　手册强烈建议不要使用root打包，以防破坏系统；也不要使用系统常用用户打包，以防上传一些用户的私密信息；所以建议建立一个专门打包的普通用户。<br> <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"> user@localhost  ~ sudo useradd makerpm</div><div class="line"> user@localhost  ~ sudo usermod <span class="_">-a</span> -G mock makerpm</div><div class="line"> user@localhost  ~ sudo passwd makerpm</div><div class="line"> user@localhost  ~ su makerpm</div><div class="line">Password: </div><div class="line">[makerpm@localhost ~]$ rpmdev-setuptree</div><div class="line">[makerpm@localhost ~]$ ls</div><div class="line">rpmbuild</div><div class="line">[makerpm@localhost ~]$</div></pre></td></tr></table></figure></p>
<p>然后打包环境就建立好了。</p>
<h1 id="2-编写spec文件">2.编写spec文件</h1><h2 id="2-1_参考已经打好的包">2.1 参考已经打好的包</h2><p>　　Fedora发布的软件都是包含源代码的，所以可以借鉴这些包的打包脚本，先模仿再创作是最便捷的学习方式。<br> <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[makerpm@localhost dist]$  dnf download --source p7zip</div><div class="line">[makerpm@localhost dist]$ mkdir p7zip-9.20.1-8.fc22</div><div class="line">[makerpm@localhost dist]$ <span class="built_in">cd</span> p7zip-9.20.1-8.fc22/</div><div class="line">[makerpm@localhost p7zip-9.20.1-8.fc22]$ rpm2cpio ../p7zip-9.20.1-8.fc22.src.rpm | cpio -i</div></pre></td></tr></table></figure></p>
<p>然后慢慢品味p7zip.spec吧！</p>
<h2 id="2-2_准备打包的源代码包">2.2 准备打包的源代码包</h2><p>　　起始环境建立好之后，打包的过程，就是编写spec文件的过程。<br>　　使用的材料是上一次的strtest工程进行打包，注意包的命名规范：name-version.tar.gz<br> <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">user@localhost  ~/Study/project/to_linux  mv strtest strtest-1.0.1</div><div class="line">user@localhost  ~/Study/project/to_linux  tar czvf strtest-1.0.1.tar.gz strtest-1.0.1</div><div class="line">user@localhost  ~/Study/project/to_linux  sudo cp strtest-1.0.1.tar.gz /home/makerpm/rpmbuild/SOURCES/</div><div class="line">user@localhost  ~/Study/project/to_linux  sudo chown makerpm:makerpm /home/makerpm/rpmbuild/SOURCES/strtest-1.0.1.tar.gz</div><div class="line">user@localhost  ~/Study/project/to_linux </div></pre></td></tr></table></figure></p>
          
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/开发基础/">开发基础</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/开发基础/">开发基础</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/服务运维/">服务运维</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/软件/">软件</a></li></ul>
    </div>

      
        <p class="article-more-link">
          <a href="/201509/rpmbuild-package-example-(1).html#more">阅读全文 >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
</article>










  
    <article id="post-generate-makefile-through-autotools" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/201509/generate-makefile-through-autotools.html" class="article-date">
      <time datetime="2015-09-28T06:29:42.000Z" itemprop="datePublished">2015-09-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/201509/generate-makefile-through-autotools.html">利用autotools自动生成项目的Makefile</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
              <p>Linux下的软件，大多要不是各个发行版打好包的，要不是源代码下来后，<br> <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./configure &amp;&amp; make &amp;&amp; make install</div></pre></td></tr></table></figure></p>
<p>　　三步曲来完成安装的。对于一个工程，简单的话可以手写Makefile，但是随着项目不断的增长，需要跟踪的文件越来越多的时候，手动维护Makefile会比较的麻烦；同时随着各个发行版和平台的差异性的处理也很尽善尽美；（<strong>当然我主要是对Makefile不太熟悉，用这个工具可以傻瓜生成Makefile，是我最大的动力！</strong>）</p>
<h1 id="1-安装autotools">1.安装autotools</h1><p>　　在我的地沟油下，是被打包成下面两个文件的：<br> <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo dnf install automake  autoconf</div></pre></td></tr></table></figure></p>
<h1 id="2-建立代码目录，添加测试的源代码文件">2.建立代码目录，添加测试的源代码文件</h1><p>　　这里直接无耻地照搬了<a href="http://blog.csdn.net/memoryjs/article/details/7860783">这里</a>的两个测试文件str.h和str.cpp<br> <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"> user@localhost  ~/Study/project/to_linux/<span class="built_in">test</span>_project  mkdir include src</div><div class="line"> user@localhost  ~/Study/project/to_linux/<span class="built_in">test</span>_project  cat include/str.h </div><div class="line"><span class="comment">#include &lt;stdio.h&gt;  </span></div><div class="line">int str(char *string);  </div><div class="line"> user@localhost  ~/Study/project/to_linux/<span class="built_in">test</span>_project  cat src/str.cpp </div><div class="line"><span class="comment">#include "str.h"</span></div><div class="line"></div><div class="line">int str(char *string)&#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"\n----PRINT STRING----\n\"%s\"\n"</span>,string);</div><div class="line">        <span class="built_in">return</span> 0;</div><div class="line">&#125;</div><div class="line"></div><div class="line">int main(int argc , char **argv)&#123;</div><div class="line">        char str_<span class="built_in">read</span>[1024];</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Please INPUT something end by [ENTER]\n"</span>);</div><div class="line">        scanf(<span class="string">"%s"</span>,str_<span class="built_in">read</span>);</div><div class="line">        <span class="built_in">return</span> str(str_<span class="built_in">read</span> );</div><div class="line">&#125;</div><div class="line"> user@localhost  ~/Study/project/to_linux/<span class="built_in">test</span>_project </div></pre></td></tr></table></figure></p>
<h1 id="3-生成configure-ac">3.生成configure.ac</h1><p>　　autoscan工具在给定目录及其子目录树中检查源文件，若没有给出目录，就在当前目录及子目录树中进行检查，并生成一个configure.scan文件。我们将这个文件命名为configure.ac(有的也命名成configure.in文件，但是.ac是新名字，建议用这个哦！)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">user@localhost  ~/Study/project/to_linux/<span class="built_in">test</span>_project  mv configure.scan configure.ac</div></pre></td></tr></table></figure></p>
<p>修改之，添加或者修改如下条目（最终的修改结果会在文末贴出）<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">AC_INIT([strtest], [1.0], [taozhijiang@gmail.com])</div><div class="line">AM_INIT_AUTOMAKE</div><div class="line">AC_PROG_CXX</div><div class="line">AC_CONFIG_FILES([Makefile])</div></pre></td></tr></table></figure></p>
<h1 id="4-执行aclocal">4.执行aclocal</h1><h1 id="5-创建Makefile-am">5.创建Makefile.am</h1><p>　　这是另外一个比较讲究的文件。<br>　　一个工程可以创建多个可执行文件，每个可执行文件可以依赖自己的源文件、编译参数等信息。<br>　　AUTOMAKE_OPTIONS提供了三个strictness等级，分别是foreign, gnu(默认), gnits三个，主要差异是对目录下的NEWS、README等要求，以及编译的输出等级等，foreign是最小等级。<br>　　详情请见<strong>info automake  3.2 Strictness</strong></p>
<h2 id="5-1_方案1">5.1 方案1</h2><p>　　我们简单使用的文件如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">AUTOMAKE_OPTIONS = foreign</div><div class="line"></div><div class="line">bin_PROGRAMS = strtest</div><div class="line">strtest_SOURCES = src/str.cpp</div><div class="line">strtest_CPPFLAGS    = -I include/  -include  ./WINTYPES.H</div></pre></td></tr></table></figure></p>
<p>　　下面很明显啦，就是每个执行文件的名字，及其源代码和额外的编译参数。<br>
          
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/开发基础/">开发基础</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/开发基础/">开发基础</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/服务运维/">服务运维</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/软件/">软件</a></li></ul>
    </div>

      
        <p class="article-more-link">
          <a href="/201509/generate-makefile-through-autotools.html#more">阅读全文 >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
</article>










  
    <article id="post-keepass-pass-save" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/201508/keepass-pass-save.html" class="article-date">
      <time datetime="2015-08-29T06:20:30.000Z" itemprop="datePublished">2015-08-29</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/201508/keepass-pass-save.html">开源的个人密码管理器软件KeePass</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
              <p>　　这个文章的标题都建立了好久了，一直没有去写。觉得就是一个软件推荐，十分的没有技术含量啊。但是用了这么久，感觉确实好用，因此整理出来推荐给大家。   </p>
<h1 id="一、KeePass的优点">一、KeePass的优点</h1><h3 id="1-1_主流的密码管理器">1.1 主流的密码管理器</h3><p>　　感觉主流的密码管理器，主要分成两类：保存在网络的和保存在本地的。</p>
<ul>
<li>前者以LastPass作为代表，所有的数据信息加密保存到云端，所以优势就是共享和更新比较的方便，但是缺点就是，万一你的密码或者供应商的数据和加密信息泄漏，你就完全被暴露了。LastPass这家公司曾经是出过此类安全问题的，有兴趣的同学可以扒扒<a href="http://www.freebuf.com/news/11898.html">这段历史</a>！</li>
<li>后者主要以1Password和LastPass作为代表。主要区别是1Password是公司的商业产品，需要很多很多美刀，支持主流的平台（Linux除外），所以基本是高帅富的钟爱，这一点在AppStore的排行榜就可以看见。后者是社区化的开源产品，所有平台都支持(<strong>甚至黑莓、WindowsPhone都支持，良心软件啊！</strong>)，Linuxer的首选，但是没有商业支持，所以死活完全自理。这一类是将密码数据库加密存储到本地，不会传递到互联网上，所以理论上是最安全的。你也可以将加密数据库存储到dropbox等网盘中，实现多设备的同步操作。<br>以上列出的管理器，都有浏览器插件支持，后面再叙述。</li>
</ul>
<h3 id="1-2_KeePass的优势">1.2 KeePass的优势</h3><ul>
<li>开源<br>　　虽然我没有精力去查看他的源代码到底安不安全，有没有后门，但是开源的东西公布在网上，我相信大众的智慧会保证产品的质量，同时众目睽睽之下没有人会做这种留后门之类的事情。</li>
<li>支持Linux<br>　　曾经是Linux的忠实拥憋，现在还看见很多人折腾它。虽然现在都在“瘟都死”下学习娱乐，但对这种真正负责任的跨平台印象还是不错的。多平台多软件选择可以参见文档。</li>
<li>免费<br>　　1Password几十上百刀的价格确实把我吓尿了。对于生活在一个“软件不要钱”的国度，我买过的最贵的软件就是Windows序列号RMB10，以及Runtastic二十多块钱折扣时候买的。</li>
<li>保存在本地，安全<br>　　人家说在世界，尤其是天朝，互联网是有国界但是没有隐私的。所以我变得“焦虑、多疑”，我只相信数据在我的手中才是安全的。所以当前我的电脑插了一个SD卡，密码数据文件放在SD卡中，SD卡可以随身携带。
          
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/生活/">生活</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/服务运维/">服务运维</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/软件/">软件</a></li></ul>
    </div>

      
        <p class="article-more-link">
          <a href="/201508/keepass-pass-save.html#more">阅读全文 >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
</article>










  
    <article id="post-learning-and-debug-linux-kernel-under-windows" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/201508/learning-and-debug-linux-kernel-under-windows.html" class="article-date">
      <time datetime="2015-08-29T03:26:52.000Z" itemprop="datePublished">2015-08-29</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/201508/learning-and-debug-linux-kernel-under-windows.html">在Windows下通过虚拟机搭建Linux内核的学习和调试环境</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
              <p>　　其实，这边文章在我的<a href="https://github.com/taozhijiang/linux/blob/master/start_to_learn_kernel_with_qemu.txt">linux的repo</a>里面已经介绍了，此处着重进行归纳和整理。</p>
<h1 id="本文重点">本文重点</h1><ul>
<li>Windows下虚拟机的嵌套</li>
<li>内核编译和ramfs镜像的制作</li>
<li>Qemu使用特定内核启动</li>
</ul>
<h1 id="一、Windows下面VMware虚拟机嵌套KVM虚拟机">一、Windows下面VMware虚拟机嵌套KVM虚拟机</h1><p>　　像我之前用Gentoo，然后搭建个KVM的虚拟机，编译启动内核是十分方便的。但是碍于现在在Windows环境工作的原因，使用Gentoo作为桌面系统，还是有些不方便的。<br>　　此外还有的一个原因，是感觉自己过了那种折腾的年龄了。往昔那种优化美化Linux桌面，寻求各种方式替代Windows的应用软件，对我已经没有任何的吸引力了。（我已老矣）<br>　　在Windows下，至少需要一个Host来交叉编译内核，然后再找个Host启动跟踪这个内核，在一台机器上面如果用虚拟机，势必涉及到虚拟机的嵌套（因为如果开两个虚拟机，我还不知道调试的虚拟机怎么指定内核来启动，除非你将新内核拷贝到测试机覆盖文件系统上的内核，显然很麻烦！！！）Qemu+KVM就是这帮搞Linux的维护开发的，<strong>看看Qemu的启动参数就能吓尿你</strong>，所以用这家伙学内核乃是正道。<br>　　默认的VMware是不支持这种嵌套虚拟化的，需要修改虚拟机的配置文件。我用的VMware Workstation 9，测试添加这些内容可行<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">apic.xapic.enabled = <span class="string">"FALSE"</span>    </div><div class="line">vcpu.hotadd = <span class="string">"FALSE"</span>  </div><div class="line">hypervisor.cpuid.v0 = <span class="string">"FALSE"</span></div></pre></td></tr></table></figure></p>
<p>　　然后在VMware里面安装你的Guest（将来也是Host）的系统吧！（我用的地沟油，贱兔太浪费时间和精力了）<br>　　然后用qemu或者virt-manager再建立一个真正的Guest系统，我同样使用的Fedora。怎么用qemu或者virt-manager装系统，我不想说，你可以去参考archlinux或者gentoo的wiki。<br>
          
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/开发进阶/">开发进阶</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/内核/">内核</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/后台开发/">后台开发</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/开发基础/">开发基础</a></li></ul>
    </div>

      
        <p class="article-more-link">
          <a href="/201508/learning-and-debug-linux-kernel-under-windows.html#more">阅读全文 >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
  
</article>










  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/10/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="page-number" href="/page/10/">10</a><span class="page-number current">11</span>
    </nav>
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2015-2017 taozj
            </div>
            <div class="footer-right">
                <a href="http://www.miitbeian.gov.cn/" target="_blank" rel="nofollow">
                    <img src="/post_images/icons/icp_min.png" alt="粤ICP备17002382号-1">粤ICP备17002382号-1
                </a>
                <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1258402767'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s11.cnzz.com/stat.php%3Fid%3D1258402767%26online%3D2' type='text/javascript'%3E%3C/script%3E"));
                </script>
                Powered by <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>, theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题">Yelee</a>  enhanced by Nicol <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
    </div>
</footer>

    </div>
    
    <script src="/js/GithubRepoWidget.js"></script>

<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.1.22/require.min.js"></script>
<script src="/js/search.js"></script> 


    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 10;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>




    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>

    <script src="//cdn.bootcss.com/jqueryui/1.10.4/jquery-ui.min.js"></script>


   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</script>

  </div>
</body>
</html>